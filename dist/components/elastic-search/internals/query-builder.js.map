{"version":3,"file":"query-builder.js","names":["SearchOperator","SearchFieldType","SearchQueryBuilder","_classCallCheck","_createClass","key","value","buildQuery","query","_this","mustClauses","filterClauses","criteria","forEach","criterion","clause","buildClauseForCriterion","shouldUseFilter","push","Query","bool","must","length","match_all","filter","field","operator","type","includes","isEmptyValue","TEXT","buildTextClause","fuzziness","KEYWORD","buildKeywordClause","BOOLEAN","buildBooleanClause","DATE","buildDateClause","NUMBER","buildNumberClause","UUID","buildUUIDClause","fieldKey","EQUALS","match_phrase","_defineProperty","CONTAINS","match","STARTS_WITH","prefix","concat","ENDS_WITH","wildcard","term","IN","values","Array","isArray","terms","GREATER_THAN","range","gt","LESS_THAN","lt","BETWEEN","gte","lte","undefined","every","v","toAPIQuery","size","sort","_score","order","created_at","default"],"sources":["../../../../src/components/elastic-search/internals/query-builder.ts"],"sourcesContent":["export enum SearchOperator {\n  EQUALS = 'equals',\n  CONTAINS = 'contains',\n  STARTS_WITH = 'starts_with',\n  ENDS_WITH = 'ends_with',\n  GREATER_THAN = 'greater_than',\n  LESS_THAN = 'less_than',\n  BETWEEN = 'between',\n  IN = 'in',\n}\n\nexport enum SearchFieldType {\n  TEXT = 'text',\n  KEYWORD = 'keyword',\n  BOOLEAN = 'boolean',\n  DATE = 'date',\n  NUMBER = 'number',\n  UUID = 'uuid',\n}\n\nexport interface SearchField {\n  key: string;\n  label: string;\n  type: SearchFieldType;\n  operators?: SearchOperator[];\n  options?: Array<{ value: string | number | boolean; label: string }>;\n  fuzziness?: string | number;\n}\n\ninterface QueryClause {\n  [key: string]: unknown;\n}\n\ninterface Query {\n  bool: {\n    must: QueryClause[];\n    filter?: QueryClause[];\n  };\n}\n\nexport interface SearchCriteria {\n  id: string;\n  field: SearchField;\n  operator: SearchOperator;\n  value: string | number | boolean | string[] | number[] | undefined;\n}\n\nexport interface SearchQuery {\n  criteria: SearchCriteria[];\n}\n\nexport default class SearchQueryBuilder {\n  static buildQuery(query: SearchQuery): Query {\n    const mustClauses: QueryClause[] = [];\n    const filterClauses: QueryClause[] = [];\n\n    query.criteria.forEach(criterion => {\n      const clause = this.buildClauseForCriterion(criterion);\n      if (clause) {\n        if (this.shouldUseFilter(criterion)) {\n          filterClauses.push(clause);\n        } else {\n          mustClauses.push(clause);\n        }\n      }\n    });\n\n    const Query: Query = {\n      bool: {\n        must: mustClauses.length > 0 ? mustClauses : [{ match_all: {} }],\n      },\n    };\n\n    if (filterClauses.length > 0) {\n      Query.bool.filter = filterClauses;\n    }\n\n    return Query;\n  }\n\n  private static shouldUseFilter(criterion: SearchCriteria): boolean {\n    const { field, operator } = criterion;\n\n    if (field.type === 'keyword' && operator === 'equals') {\n      return true;\n    }\n\n    if (field.type === 'boolean') {\n      return true;\n    }\n\n    if (\n      (field.type === 'date' || field.type === 'number') &&\n      ['greater_than', 'less_than', 'between'].includes(operator)\n    ) {\n      return true;\n    }\n\n    return false;\n  }\n\n  private static buildClauseForCriterion(\n    criterion: SearchCriteria\n  ): QueryClause | null {\n    const { field, operator, value } = criterion;\n\n    if (this.isEmptyValue(value)) {\n      return null;\n    }\n\n    switch (field.type) {\n      case SearchFieldType.TEXT:\n        return this.buildTextClause(\n          field.key,\n          operator,\n          value as string,\n          field.fuzziness\n        );\n\n      case SearchFieldType.KEYWORD:\n        return this.buildKeywordClause(\n          field.key,\n          operator,\n          value as string | number | boolean | string[] | number[]\n        );\n\n      case SearchFieldType.BOOLEAN:\n        return this.buildBooleanClause(field.key, value as boolean);\n\n      case SearchFieldType.DATE:\n        return this.buildDateClause(\n          field.key,\n          operator,\n          value as string | string[]\n        );\n\n      case SearchFieldType.NUMBER:\n        return this.buildNumberClause(\n          field.key,\n          operator,\n          value as number | number[]\n        );\n\n      case SearchFieldType.UUID:\n        return this.buildUUIDClause(\n          field.key,\n          operator,\n          value as string | string[]\n        );\n\n      default:\n        return null;\n    }\n  }\n\n  private static buildTextClause(\n    fieldKey: string,\n    operator: SearchOperator,\n    value: string,\n    fuzziness?: string | number\n  ): QueryClause {\n    switch (operator) {\n      case SearchOperator.EQUALS:\n        return {\n          match_phrase: {\n            [fieldKey]: value,\n          },\n        };\n\n      case SearchOperator.CONTAINS:\n        return {\n          match: {\n            [fieldKey]: {\n              query: value,\n              fuzziness: fuzziness || 'AUTO',\n            },\n          },\n        };\n\n      case SearchOperator.STARTS_WITH:\n        return {\n          prefix: {\n            [`${fieldKey}.keyword`]: value,\n          },\n        };\n\n      case SearchOperator.ENDS_WITH:\n        return {\n          wildcard: {\n            [`${fieldKey}.keyword`]: `*${value}`,\n          },\n        };\n\n      default:\n        return {\n          match: {\n            [fieldKey]: value,\n          },\n        };\n    }\n  }\n\n  private static buildKeywordClause(\n    fieldKey: string,\n    operator: SearchOperator,\n    value: string | number | boolean | string[] | number[]\n  ): QueryClause {\n    switch (operator) {\n      case SearchOperator.EQUALS:\n        return {\n          term: {\n            [fieldKey]: value,\n          },\n        };\n\n      case SearchOperator.CONTAINS:\n        return {\n          wildcard: {\n            [fieldKey]: `*${value}*`,\n          },\n        };\n\n      case SearchOperator.STARTS_WITH:\n        return {\n          prefix: {\n            [fieldKey]: value,\n          },\n        };\n\n      case SearchOperator.ENDS_WITH:\n        return {\n          wildcard: {\n            [fieldKey]: `*${value}`,\n          },\n        };\n\n      case SearchOperator.IN: {\n        const values = Array.isArray(value) ? value : [value];\n        return {\n          terms: {\n            [fieldKey]: values,\n          },\n        };\n      }\n\n      default:\n        return {\n          term: {\n            [fieldKey]: value,\n          },\n        };\n    }\n  }\n\n  private static buildBooleanClause(\n    fieldKey: string,\n    value: boolean\n  ): QueryClause {\n    return {\n      term: {\n        [fieldKey]: value,\n      },\n    };\n  }\n\n  private static buildDateClause(\n    fieldKey: string,\n    operator: SearchOperator,\n    value: string | string[]\n  ): QueryClause {\n    switch (operator) {\n      case SearchOperator.EQUALS:\n        return {\n          term: {\n            [fieldKey]: value,\n          },\n        };\n\n      case SearchOperator.GREATER_THAN:\n        return {\n          range: {\n            [fieldKey]: {\n              gt: value,\n            },\n          },\n        };\n\n      case SearchOperator.LESS_THAN:\n        return {\n          range: {\n            [fieldKey]: {\n              lt: value,\n            },\n          },\n        };\n\n      case SearchOperator.BETWEEN: {\n        const values = Array.isArray(value) ? value : [value, value];\n        return {\n          range: {\n            [fieldKey]: {\n              gte: values[0],\n              lte: values[1],\n            },\n          },\n        };\n      }\n\n      default:\n        return {\n          term: {\n            [fieldKey]: value,\n          },\n        };\n    }\n  }\n\n  private static buildNumberClause(\n    fieldKey: string,\n    operator: SearchOperator,\n    value: number | number[]\n  ): QueryClause {\n    switch (operator) {\n      case SearchOperator.EQUALS:\n        return {\n          term: {\n            [fieldKey]: value,\n          },\n        };\n\n      case SearchOperator.GREATER_THAN:\n        return {\n          range: {\n            [fieldKey]: {\n              gt: value,\n            },\n          },\n        };\n\n      case SearchOperator.LESS_THAN:\n        return {\n          range: {\n            [fieldKey]: {\n              lt: value,\n            },\n          },\n        };\n\n      case SearchOperator.BETWEEN: {\n        const values = Array.isArray(value) ? value : [value, value];\n        return {\n          range: {\n            [fieldKey]: {\n              gte: values[0],\n              lte: values[1],\n            },\n          },\n        };\n      }\n\n      default:\n        return {\n          term: {\n            [fieldKey]: value,\n          },\n        };\n    }\n  }\n\n  private static buildUUIDClause(\n    fieldKey: string,\n    operator: SearchOperator,\n    value: string | string[]\n  ): QueryClause {\n    switch (operator) {\n      case SearchOperator.EQUALS:\n        return {\n          term: {\n            [fieldKey]: value,\n          },\n        };\n\n      case SearchOperator.IN: {\n        const values = Array.isArray(value) ? value : [value];\n        return {\n          terms: {\n            [fieldKey]: values,\n          },\n        };\n      }\n\n      default:\n        return {\n          term: {\n            [fieldKey]: value,\n          },\n        };\n    }\n  }\n\n  private static isEmptyValue(\n    value: string | number | boolean | string[] | number[] | undefined\n  ): boolean {\n    if (value === null || value === undefined || value === '') {\n      return true;\n    }\n\n    if (Array.isArray(value)) {\n      return (\n        value.length === 0 ||\n        value.every(v => v === '' || v === null || v === undefined)\n      );\n    }\n\n    return false;\n  }\n\n  // utility to help structure the query into a menaingful api request\n  // perhaps should be moved to the consuming app, pending\n  // unknown because this varies based on consumer's design\n  static toAPIQuery(query: SearchQuery): Record<string, unknown> {\n    return {\n      query: this.buildQuery(query),\n      size: 50,\n      sort: [{ _score: { order: 'desc' } }, { created_at: { order: 'desc' } }],\n    };\n  }\n}\n"],"mappings":"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","ignoreList":[]}